# 내부 반복자
<br/>

for 문과 Iterator는 컬렉션의 요소를 컬렉션 바깥쪽으로 반복해서 가져와 처리하는데, 이것을 **`외부 반복자`** 라고 한다.
반면 스트림은 **요소 처리 방법을 컬렉션 내부로 주입시켜서 요소를 반복 처리**하는데, 이것을 **`내부 반복자`** 라고 한다.

다음 그림을 보면서 외부 반복자와 내부 반복자를 이해해보자.

<img src="https://github.com/silxbro/java/assets/142463332/20a87712-70e0-4a1d-8c78-71f9c56c8ffd" width="500" height="250"/><br/>

외부 반복자일 경우는 컬렉션의 요소를 외부로 가져오는 코드와 처리하는 코드를 모두 개발자 코드가 가지고 있어야 한다.
반면 내부 반복자일 경우는 개발자 코드에서 제공한 **데이터 처리 코드(`람다식`)** 를 가지고 **컬렉션 내부에서 요소를 반복 처리**한다.

내부 반복자는 멀티 코어 CPU를 최대한 활용하기 위해 **요소들을 분배시켜 `병렬 작업`** 을 할 수 있다.
하나씩 처리하는 순차적 외부 반복자보다는 **효율적**으로 요소를 반복시킬 수 있다는 장점이 있다.

<img src="https://github.com/silxbro/java/assets/142463332/8974cd55-dcf2-4712-951d-319305324c4a" width="300" height="250"/><br/>

<br/>

다음 예제는 List 컬렉션의 내부 반복자를 이용해서 병렬 처리하는 방법을 보여준다. **`parallelStream()` 메소드** 로 병렬 처리 스트림을 얻고,
forEach() 메소드를 호출할 때 요소 처리 방법인 람다식을 제공한다. 람다식은 처리되는 요소가 무엇이고, 어떤 스레드가 처리하는지를 출력한다.
- [ParallelStreamExample.java](https://github.com/silxbro/java/blob/main/src/thisisjava/ch17/sec02/ParallelStreamExample.java)
